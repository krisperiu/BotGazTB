# Проект Telegram-бота

Этот проект представляет собой Telegram-бота, разработанного с использованием библиотеки Aiogram. Бот предназначен для взаимодействия с пользователями и модераторами, предоставляя функционал для оставления и управления отчетами о состоянии автобусов.

## Стек технологий

- **Python**: Язык программирования для реализации бота.
- **aiogram**: Библиотека для работы с Telegram Bot API.
- **SQLAlchemy**: ORM для работы с базой данных PostgreSQL.
- **PostgreSQL**: Система управления базами данных.

## Файлы проекта

### `run.py`

Основной скрипт для запуска Telegram-бота. Этот файл инициализирует бота и запускает его, используя библиотеку Aiogram.

### `models.py`

Файл содержит определения моделей для SQLAlchemy, а также настройки для асинхронной работы с базой данных. Здесь описаны структуры таблиц базы данных и их связи.

### `requests.py`

Файл с асинхронными функциями для работы с базой данных, используя SQLAlchemy ORM. Содержит функции для управления данными отчетов, администраторов и фотографий.

### `handlers.py`

Основной скрипт для обработки сообщений и взаимодействия с пользователями. В этом файле определены обработчики команд и сообщений бота, а также логика для взаимодействия с пользователями и модераторами.

### `keyboards.py`

Файл содержит код для создания различных клавиатур для Telegram-бота с помощью библиотеки Aiogram. Здесь определены клавиатуры для пользователей, модераторов и администраторов, включая поддержку пагинации.

### `.env`

Файл для хранения конфиденциальной информации и настроек, таких как токены API и строки подключения к базе данных. Этот файл содержит переменные окружения, которые используются приложением для подключения к внешним сервисам.

## Установка и настройка PostgreSQL на Ubuntu

1. **Установите PostgreSQL:**

    Откройте терминал и выполните следующую команду:

    ```bash
    sudo apt update
    sudo apt install postgresql postgresql-contrib
    ```

2. **Запустите и проверьте статус службы PostgreSQL:**

    ```bash
    sudo systemctl start postgresql
    sudo systemctl enable postgresql
    sudo systemctl status postgresql
    ```

3. **Создайте пользователя и базу данных для вашего приложения:**

    - Перейдите в консоль PostgreSQL от имени суперпользователя:

      ```bash
      sudo -u postgres psql
      ```

    - Создайте нового пользователя:

      ```sql
      CREATE USER your_username WITH PASSWORD 'your_password';
      ```

    - Создайте базу данных и назначьте владельца:

      ```sql
      CREATE DATABASE your_database_name WITH OWNER your_username;
      ```

    - Дайте пользователю все права на базу данных:

      ```sql
      GRANT ALL PRIVILEGES ON DATABASE your_database_name TO your_username;
      ```

    - Выйдите из консоли PostgreSQL:

      ```sql
      \q
      ```

4. **Настройте соединение с базой данных в вашем проекте:**

    Создайте файл `.env` в корне проекта и добавьте туда следующие переменные:

    ```
    TOKEN=ваш_токен_бота
    SQLALCHEMY_URL=postgresql+asyncpg://your_username:your_password@localhost/your_database_name
    ```

## Установка и запуск

1. **Клонируйте репозиторий:**

    ```bash
    git clone https://github.com/krisperiu/BotGaz.git
    cd your-project
    ```

2. **Создайте и активируйте виртуальное окружение:**

    ```bash
    python3 -m venv venv
    source venv/bin/activate
    ```

3. **Установите зависимости:**

    ```bash
    pip install -r requirements.txt
    ```

4. **Запустите бота:**

    ```bash
    python run.py
    ```
